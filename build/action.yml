name: 'Build'
description: 'Restores packages and builds projects'
inputs:
   ctxt:
    description: "Context from the setup step"
    required: true
outputs:
  ctxt:
    description: "The build context"
    value: ${{ steps.update-context.outputs.ctxt }}
runs:
runs:
  using: "composite"
  steps:
    - name: Restore All
      shell: pwsh
      run: dotnet restore

    # Build Packages from src directory.
    - name: Build Packages
      shell: pwdh
      run: ${{ github.action_path }}/build.ps1 -ctxt $(ConvertFrom-Json '${{ inputs.ctxt }}')